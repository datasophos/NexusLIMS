
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>NexusLIMS Database &#8212; NexusLIMS dev documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=acda69ee" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=3ce10a4d"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=30646c52"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'dev_guide/database';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = '_static/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'dev';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            true;
        </script>
    <script src="../_static/custom.js?v=ba087cdf"></script>
    <link rel="canonical" href="https://datasophos.github.io/NexusLIMS/latest/dev_guide/database.html" />
    <link rel="icon" href="../_static/nexusLIMS_bare_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="XML Schema Reference" href="schema_documentation.html" />
    <link rel="prev" title="Migration from Poetry to uv" href="uv_migration.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="dev" />
    <meta name="docbuild:last-update" content="Jan, 29, 2026"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo_horizontal_light.png" class="logo__image only-light" alt="NexusLIMS dev documentation - Home"/>
    <img src="../_static/logo_horizontal_dark.png" class="logo__image only-dark pst-js-only" alt="NexusLIMS dev documentation - Home"/>
  
  
</a></div>
    
      <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../index.html">
    Home
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../migration.html">
    Migration Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../dev_guide.html">
    Dev Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../frontend_guide.html">
    Frontend Guide
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../reference.html">
    Reference
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/datasophos/NexusLIMS" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://datasophos.co" title="Datasophos" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-globe fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Datasophos</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../index.html">
    Home
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../migration.html">
    Migration Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../dev_guide.html">
    Dev Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../frontend_guide.html">
    Frontend Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../reference.html">
    Reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/datasophos/NexusLIMS" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://datasophos.co" title="Datasophos" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-globe fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Datasophos</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="development.html">Development introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="writing_extractor_plugins.html">Writing Extractor Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="writing_export_destinations.html">Writing Export Destination Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="instrument_profiles.html">Instrument Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="nexuslims_internal_schema.html">Internal Metadata Schema System</a></li>
<li class="toctree-l1"><a class="reference internal" href="em_glossary_reference.html">EM Glossary Field Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="uv_migration.html">Migration from Poetry to uv</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">NexusLIMS Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="schema_documentation.html">XML Schema Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing/integration-tests.html">Integration Testing Guide</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../dev_guide.html" class="nav-link">Dev Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">NexusLIMS Database</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="nexuslims-database">
<h1>NexusLIMS Database<a class="headerlink" href="#nexuslims-database" title="Link to this heading">#</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>NexusLIMS uses a <a class="reference external" href="https://sqlite.org/index.html">SQLite</a> database to track experimental sessions and instrument configuration. The database file location is specified by <a class="reference internal" href="../user_guide/configuration.html#config-db-path"><span class="std std-ref">NX_DB_PATH</span></a>.</p>
<p><strong>Key features:</strong></p>
<ul class="simple">
<li><p>Single-file database for easy backup (just copy the file)</p></li>
<li><p>Created from <a class="reference external" href="https://github.com/datasophos/NexusLIMS/blob/main/nexusLIMS/db/dev/NexusLIMS_db_creation_script.sql">SQL Schema Definition</a></p></li>
<li><p>Inspectable with database tools such as <a class="reference external" href="https://sqlitebrowser.org/">DB Browser for SQLite</a></p></li>
</ul>
</section>
<section id="sqlmodel-orm-migration">
<h2>SQLModel ORM Migration<a class="headerlink" href="#sqlmodel-orm-migration" title="Link to this heading">#</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.2.0: </span>NexusLIMS now uses <a class="reference external" href="https://sqlmodel.tiangolo.com/">SQLModel</a> for database operations instead of raw SQL queries. This provides type safety, automatic datetime handling, and cleaner code.</p>
</div>
<section id="notable-changes">
<h3>Notable Changes<a class="headerlink" href="#notable-changes" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">db_query()</span></code> function for manual database queries has been completely removed from <a class="reference internal" href="../api/nexusLIMS/nexusLIMS.db.session_handler.html#module-nexusLIMS.db.session_handler" title="nexusLIMS.db.session_handler"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nexusLIMS.db.session_handler</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EventType</span></code> and <code class="docutils literal notranslate"><span class="pre">RecordStatus</span></code> are now enums (<a class="reference internal" href="../api/nexusLIMS/nexusLIMS.db.enums.html#nexusLIMS.db.enums.EventType" title="nexusLIMS.db.enums.EventType"><code class="xref py py-class docutils literal notranslate"><span class="pre">EventType</span></code></a>, <a class="reference internal" href="../api/nexusLIMS/nexusLIMS.db.enums.html#nexusLIMS.db.enums.RecordStatus" title="nexusLIMS.db.enums.RecordStatus"><code class="xref py py-class docutils literal notranslate"><span class="pre">RecordStatus</span></code></a>) instead of string literals</p></li>
<li><p><a class="reference internal" href="../api/nexusLIMS/nexusLIMS.db.models.html#nexusLIMS.db.models.SessionLog" title="nexusLIMS.db.models.SessionLog"><code class="xref py py-class docutils literal notranslate"><span class="pre">SessionLog</span></code></a> and <a class="reference internal" href="../api/nexusLIMS/nexusLIMS.db.models.html#nexusLIMS.db.models.Instrument" title="nexusLIMS.db.models.Instrument"><code class="xref py py-class docutils literal notranslate"><span class="pre">Instrument</span></code></a> are now SQLModel classes with real object-relational mapping</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">Instrument</span></code> dataclass has been replaced with a SQLModel class - use <code class="docutils literal notranslate"><span class="pre">instrument_pid</span></code> field instead of <code class="docutils literal notranslate"><span class="pre">name</span></code></p></li>
</ul>
</section>
<section id="migration-examples">
<h3>Migration Examples<a class="headerlink" href="#migration-examples" title="Link to this heading">#</a></h3>
<p><strong>Creating session log entries:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># New approach: has not changed significantly other than using enums</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nexusLIMS.db.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">SessionLog</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nexusLIMS.db.enums</span><span class="w"> </span><span class="kn">import</span> <span class="n">EventType</span><span class="p">,</span> <span class="n">RecordStatus</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span> <span class="k">as</span> <span class="n">dt</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">SessionLog</span><span class="p">(</span>
    <span class="n">session_identifier</span><span class="o">=</span><span class="s2">&quot;abc&quot;</span><span class="p">,</span>
    <span class="n">instrument</span><span class="o">=</span><span class="s2">&quot;FEI-Titan-TEM&quot;</span><span class="p">,</span>
    <span class="n">timestamp</span><span class="o">=</span><span class="n">dt</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="s2">&quot;2025-01-15T10:00:00&quot;</span><span class="p">),</span>
    <span class="n">event_type</span><span class="o">=</span><span class="n">EventType</span><span class="o">.</span><span class="n">START</span><span class="p">,</span>
    <span class="n">record_status</span><span class="o">=</span><span class="n">RecordStatus</span><span class="o">.</span><span class="n">TO_BE_BUILT</span><span class="p">,</span>
    <span class="n">user</span><span class="o">=</span><span class="s2">&quot;alice&quot;</span>
<span class="p">)</span>
<span class="n">log</span><span class="o">.</span><span class="n">insert_log</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Querying the database:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Old approach (deprecated)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">results</span> <span class="o">=</span> <span class="n">db_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM session_log WHERE record_status = ?&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;TO_BE_BUILT&quot;</span><span class="p">,))</span>

<span class="c1"># New approach</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sqlmodel</span><span class="w"> </span><span class="kn">import</span> <span class="n">Session</span><span class="p">,</span> <span class="n">select</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nexusLIMS.db.engine</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_engine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nexusLIMS.db.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">SessionLog</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">nexusLIMS.db.enums</span><span class="w"> </span><span class="kn">import</span> <span class="n">RecordStatus</span>

<span class="k">with</span> <span class="n">Session</span><span class="p">(</span><span class="n">get_engine</span><span class="p">())</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
        <span class="n">select</span><span class="p">(</span><span class="n">SessionLog</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">SessionLog</span><span class="o">.</span><span class="n">record_status</span> <span class="o">==</span> <span class="n">RecordStatus</span><span class="o">.</span><span class="n">TO_BE_BUILT</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Benefits of SQLModel:</strong></p>
<ul class="simple">
<li><p>Type-safe database operations with IDE autocomplete and type checking</p></li>
<li><p>Automatic datetime serialization/deserialization</p></li>
<li><p>Relationship navigation (e.g., <code class="docutils literal notranslate"><span class="pre">session_log.instrument_obj</span></code>)</p></li>
<li><p>~50% less boilerplate code</p></li>
<li><p>Foundation for Alembic migrations (database schema version control)</p></li>
</ul>
</section>
</section>
<section id="database-migrations-with-alembic">
<h2>Database Migrations with Alembic<a class="headerlink" href="#database-migrations-with-alembic" title="Link to this heading">#</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.2.0: </span>NexusLIMS now uses <a class="reference external" href="https://alembic.sqlalchemy.org/">Alembic</a> for database schema version control and migrations.</p>
</div>
<p>Alembic provides a way to track and manage changes to the database schema over time, making it safe to upgrade existing installations and ensuring schema consistency across deployments.</p>
<section id="for-existing-installations">
<h3>For Existing Installations<a class="headerlink" href="#for-existing-installations" title="Link to this heading">#</a></h3>
<p>If you have an existing NexusLIMS database (created before version 2.2.0), you need to mark it as migrated to the baseline schema:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mark existing database as migrated to current schema</span>
uv<span class="w"> </span>run<span class="w"> </span>alembic<span class="w"> </span>stamp<span class="w"> </span>head
</pre></div>
</div>
<p>This tells Alembic that your database already has the current schema structure and doesn’t need the baseline migration applied.</p>
</section>
<section id="common-alembic-commands">
<h3>Common Alembic Commands<a class="headerlink" href="#common-alembic-commands" title="Link to this heading">#</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check current migration status</span>
uv<span class="w"> </span>run<span class="w"> </span>alembic<span class="w"> </span>current

<span class="c1"># View migration history</span>
uv<span class="w"> </span>run<span class="w"> </span>alembic<span class="w"> </span><span class="nb">history</span><span class="w"> </span>--verbose

<span class="c1"># Upgrade to latest schema version</span>
uv<span class="w"> </span>run<span class="w"> </span>alembic<span class="w"> </span>upgrade<span class="w"> </span>head

<span class="c1"># Downgrade one migration</span>
uv<span class="w"> </span>run<span class="w"> </span>alembic<span class="w"> </span>downgrade<span class="w"> </span>-1

<span class="c1"># Generate a new migration (after modifying SQLModel models)</span>
uv<span class="w"> </span>run<span class="w"> </span>alembic<span class="w"> </span>revision<span class="w"> </span>--autogenerate<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Description of changes&quot;</span>
</pre></div>
</div>
</section>
<section id="creating-new-migrations">
<h3>Creating New Migrations<a class="headerlink" href="#creating-new-migrations" title="Link to this heading">#</a></h3>
<p>When you modify the database schema (by changing <a class="reference internal" href="../api/nexusLIMS/nexusLIMS.db.models.html#nexusLIMS.db.models.SessionLog" title="nexusLIMS.db.models.SessionLog"><code class="xref py py-class docutils literal notranslate"><span class="pre">SessionLog</span></code></a> or <a class="reference internal" href="../api/nexusLIMS/nexusLIMS.db.models.html#nexusLIMS.db.models.Instrument" title="nexusLIMS.db.models.Instrument"><code class="xref py py-class docutils literal notranslate"><span class="pre">Instrument</span></code></a>), you should create a migration:</p>
<ol class="arabic">
<li><p><strong>Modify the SQLModel classes</strong> in <code class="docutils literal notranslate"><span class="pre">nexusLIMS/db/models.py</span></code></p></li>
<li><p><strong>Generate migration script</strong>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>uv<span class="w"> </span>run<span class="w"> </span>alembic<span class="w"> </span>revision<span class="w"> </span>--autogenerate<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Add new field to SessionLog&quot;</span>
</pre></div>
</div>
</li>
<li><p><strong>Review the generated script</strong> in <code class="docutils literal notranslate"><span class="pre">migrations/versions/</span></code></p></li>
<li><p><strong>Test the migration</strong>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply migration</span>
uv<span class="w"> </span>run<span class="w"> </span>alembic<span class="w"> </span>upgrade<span class="w"> </span>head

<span class="c1"># Test downgrade</span>
uv<span class="w"> </span>run<span class="w"> </span>alembic<span class="w"> </span>downgrade<span class="w"> </span>-1

<span class="c1"># Re-apply</span>
uv<span class="w"> </span>run<span class="w"> </span>alembic<span class="w"> </span>upgrade<span class="w"> </span>head
</pre></div>
</div>
</li>
<li><p><strong>Commit the migration script</strong> to version control</p></li>
</ol>
</section>
<section id="migration-configuration">
<h3>Migration Configuration<a class="headerlink" href="#migration-configuration" title="Link to this heading">#</a></h3>
<p>Alembic configuration is stored in:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> under <code class="docutils literal notranslate"><span class="pre">[tool.alembic]</span></code> - Source code configuration (migration paths, etc.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">migrations/env.py</span></code> - Migration environment setup (automatically reads <a class="reference internal" href="../user_guide/configuration.html#config-db-path"><span class="std std-ref">NX_DB_PATH</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">migrations/versions/</span></code> - Migration scripts directory</p></li>
</ul>
<p>The database URL is automatically set from the <a class="reference internal" href="../user_guide/configuration.html#config-db-path"><span class="std std-ref">NX_DB_PATH</span></a> environment variable in <code class="docutils literal notranslate"><span class="pre">env.py</span></code>, so you don’t need to configure it separately. All Alembic configuration lives in <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>, eliminating the need for a separate <code class="docutils literal notranslate"><span class="pre">alembic.ini</span></code> file.</p>
</section>
<section id="important-notes">
<h3>Important Notes<a class="headerlink" href="#important-notes" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Always backup your database</strong> before running migrations on production data</p></li>
<li><p><strong>Test migrations thoroughly</strong> in a development environment first</p></li>
<li><p><strong>Never edit applied migrations</strong> - create a new migration to fix issues</p></li>
<li><p>The initial migration (<code class="docutils literal notranslate"><span class="pre">57f0798d0c6d_initial_schema_baseline.py</span></code>) is a no-op baseline for existing installations</p></li>
</ul>
</section>
</section>
<section id="database-structure">
<h2>Database Structure<a class="headerlink" href="#database-structure" title="Link to this heading">#</a></h2>
<p>The database contains two primary tables:</p>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">session_log</span></code></strong> - Tracks experimental sessions and record building status</p>
<ul class="simple">
<li><p>Records when users start/end experiments</p></li>
<li><p>Tracks record building attempts and completion</p></li>
<li><p>Populated by harvesters (e.g., <a class="reference internal" href="../api/nexusLIMS/nexusLIMS.harvesters.nemo.html#module-nexusLIMS.harvesters.nemo" title="nexusLIMS.harvesters.nemo"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nemo</span></code></a>)</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">instruments</span></code></strong> - Stores authoritative instrument configuration</p>
<ul class="simple">
<li><p>Instrument names and PIDs</p></li>
<li><p>Reservation system URLs</p></li>
<li><p>Data storage paths</p></li>
<li><p>Harvester configuration</p></li>
</ul>
</li>
</ol>
</section>
<section id="the-session-log-table">
<h2>The <code class="docutils literal notranslate"><span class="pre">session_log</span></code> Table<a class="headerlink" href="#the-session-log-table" title="Link to this heading">#</a></h2>
<section id="purpose">
<h3>Purpose<a class="headerlink" href="#purpose" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">session_log</span></code> table tracks experimental sessions from start to finish. Harvesters (like <a class="reference internal" href="../api/nexusLIMS/nexusLIMS.harvesters.nemo.html#module-nexusLIMS.harvesters.nemo" title="nexusLIMS.harvesters.nemo"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nemo</span></code></a>) populate this table by parsing reservation system APIs and creating timestamped event logs.</p>
</section>
<section id="how-it-works">
<h3>How It Works<a class="headerlink" href="#how-it-works" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Session Events</strong> - Each row represents a timestamped event:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">START</span></code> - User begins experiment</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">END</span></code> - User completes experiment</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RECORD_GENERATION</span></code> - Record building attempted</p></li>
</ul>
</li>
<li><p><strong>Session Linking</strong> - Events are linked by <code class="docutils literal notranslate"><span class="pre">session_identifier</span></code> to represent a complete experimental session</p></li>
<li><p><strong>Record Building Workflow</strong>:</p>
<ul class="simple">
<li><p>Harvester creates <code class="docutils literal notranslate"><span class="pre">START</span></code> and <code class="docutils literal notranslate"><span class="pre">END</span></code> events with status <code class="docutils literal notranslate"><span class="pre">TO_BE_BUILT</span></code></p></li>
<li><p>Back-end polls for sessions with <code class="docutils literal notranslate"><span class="pre">TO_BE_BUILT</span></code> status</p></li>
<li><p>Record builder finds files created between start/end timestamps</p></li>
<li><p>Status updated to <code class="docutils literal notranslate"><span class="pre">COMPLETED</span></code> or <code class="docutils literal notranslate"><span class="pre">ERROR</span></code> to prevent duplicates</p></li>
<li><p>See <a class="reference internal" href="../user_guide/record_building.html"><span class="doc">record building</span></a> for details</p></li>
</ul>
</li>
</ol>
</section>
<section id="table-schema">
<h3>Table Schema<a class="headerlink" href="#table-schema" title="Link to this heading">#</a></h3>
<p>The following columns define the <code class="docutils literal notranslate"><span class="pre">session_log</span></code> table structure:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Data type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">id_session_log</span></code></p></td>
<td><p>INTEGER</p></td>
<td><p>The auto-incrementing primary key identifier for this table (just a generic number).<br><br><em>Checks:</em> must not be <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">session_identifier</span></code></p></td>
<td><p>VARCHAR(36)</p></td>
<td><p>A unique string (could be a UUID) that is consistent among a single record’s <code class="docutils literal notranslate"><span class="pre">&quot;START&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;END&quot;</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;RECORD_GENERATION&quot;</span></code> events.<br><br><em>Checks:</em> must not be <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">instrument</span></code></p></td>
<td><p>VARCHAR(100)</p></td>
<td><p>The instrument PID associated with this session (this value is a foreign key reference to the <code class="docutils literal notranslate"><span class="pre">instruments</span></code> table).<br><br><em>Checks:</em> value must be one of those from the <code class="docutils literal notranslate"><span class="pre">instrument_pid</span></code> column of the <a class="reference internal" href="#instr-table"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">instruments</span></code></span></a> table.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">timestamp</span></code></p></td>
<td><p>DATETIME</p></td>
<td><p>The date and time of the logged event in ISO timestamp format.<br><br><em>Default:</em> <code class="docutils literal notranslate"><span class="pre">strftime('%Y-%m-%dT%H:%M:%f',</span> <span class="pre">'now',</span> <span class="pre">'localtime')</span></code><br><br><em>Checks:</em> must not be <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">event_type</span></code></p></td>
<td><p>TEXT</p></td>
<td><p>The type of log for this session.<br><br><em>Checks:</em> must be one of <code class="docutils literal notranslate"><span class="pre">&quot;START&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;END&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;RECORD_GENERATION&quot;</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">record_status</span></code></p></td>
<td><p>TEXT</p></td>
<td><p>The status of the record associated with this session. This value will be updated after a record is built for a given session.<br><br><em>Default:</em> <code class="docutils literal notranslate"><span class="pre">&quot;WAITING_FOR_END&quot;</span></code><br><br><em>Checks:</em> must be one of:<br>• <code class="docutils literal notranslate"><span class="pre">&quot;WAITING_FOR_END&quot;</span></code> - session has a start event, but no end event<br>• <code class="docutils literal notranslate"><span class="pre">&quot;TO_BE_BUILT&quot;</span></code> - session has ended, but record not yet built<br>• <code class="docutils literal notranslate"><span class="pre">&quot;COMPLETED&quot;</span></code> - record has been built successfully<br>• <code class="docutils literal notranslate"><span class="pre">&quot;ERROR&quot;</span></code> - some error happened during record generation<br>• <code class="docutils literal notranslate"><span class="pre">&quot;NO_FILES_FOUND&quot;</span></code> - record generation occurred, but no files matched time span<br>• <code class="docutils literal notranslate"><span class="pre">&quot;NO_CONSENT&quot;</span></code> - user did not consent to data harvesting<br>• <code class="docutils literal notranslate"><span class="pre">&quot;NO_RESERVATION&quot;</span></code> - no matching reservation found for this session</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">user</span></code></p></td>
<td><p>VARCHAR(50)</p></td>
<td><p>A username associated with this session (if known) – this value is not currently used by the back-end since it is not reliable across different instruments.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="the-instruments-table">
<span id="instr-table"></span><h2>The <code class="docutils literal notranslate"><span class="pre">instruments</span></code> Table<a class="headerlink" href="#the-instruments-table" title="Link to this heading">#</a></h2>
<p>This table serves as the authoritative data source for the NexusLIMS back-end
regarding information about the instruments in the Nexus Facility. By locating
this information in an external database, changes to instrument configuration
(or addition of a new instrument) requires making adjustments to just one
location, simplifying maintenance of the system.</p>
<p><strong>Back-end implementation details</strong></p>
<p>When the <a class="reference internal" href="../api/nexusLIMS/nexusLIMS.html#module-nexusLIMS" title="nexusLIMS"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nexusLIMS</span></code></a> module is imported, one of the “setup” tasks
performed is to perform a basic object-relational mapping between rows of
the <code class="docutils literal notranslate"><span class="pre">instruments</span></code> table from the database into
<a class="reference internal" href="../api/nexusLIMS/nexusLIMS.db.models.html#nexusLIMS.db.models.Instrument" title="nexusLIMS.db.models.Instrument"><code class="xref py py-class docutils literal notranslate"><span class="pre">Instrument</span></code></a> objects. These objects are
stored in a dictionary attribute named <a class="reference internal" href="../api/nexusLIMS/nexusLIMS.instruments.html#nexusLIMS.instruments.instrument_db" title="nexusLIMS.instruments.instrument_db"><code class="xref py py-data docutils literal notranslate"><span class="pre">nexusLIMS.instruments.instrument_db</span></code></a>.
This is done by querying the database specified in the environment variable
<a class="reference internal" href="../user_guide/configuration.html#config-db-path"><span class="std std-ref">NX_DB_PATH</span></a> and creating a dictionary of
<a class="reference internal" href="../api/nexusLIMS/nexusLIMS.db.models.html#nexusLIMS.db.models.Instrument" title="nexusLIMS.db.models.Instrument"><code class="xref py py-class docutils literal notranslate"><span class="pre">Instrument</span></code></a> objects that contain information
about all of the instruments specified in the database. These objects are used
widely throughout the code so that the database is only queried once at initial
import, rather than every time information is needed.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Data type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">instrument_pid</span></code></p></td>
<td><p>VARCHAR(100)</p></td>
<td><p>The unique identifier for an instrument in the facility, typically built from the make, model, and type of instrument, plus a unique numeric code (e.g. <code class="docutils literal notranslate"><span class="pre">Vendor-Model-Type-12345</span></code> )</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">api_url</span></code></p></td>
<td><p>TEXT</p></td>
<td><p>The calendar API endpoint url for this instrument’s scheduler</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">calendar_name</span></code></p></td>
<td><p>TEXT</p></td>
<td><p>The “user-friendly” name of the calendar for this instrument as displayed on the reservation system resource (e.g. “FEI Titan TEM”)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">calendar_url</span></code></p></td>
<td><p>TEXT</p></td>
<td><p><strong>[Deprecated]</strong> The URL to this instrument’s web-accessible calendar on the SharePoint resource (this is no longer used after SharePoint support was removed)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">location</span></code></p></td>
<td><p>VARCHAR(100)</p></td>
<td><p>The physical location of this instrument</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">schema_name</span></code></p></td>
<td><p>TEXT</p></td>
<td><p>The human-readable name of instrument as defined in the Nexus Microscopy schema and displayed in the records</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">property_tag</span></code></p></td>
<td><p>VARCHAR(20)</p></td>
<td><p>A unique numeric identifier for this instrument (not used by NexusLIMS, but for reference and potential future use)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">filestore_path</span></code></p></td>
<td><p>TEXT</p></td>
<td><p>The path (relative to central storage location specified in <a class="reference internal" href="../user_guide/configuration.html#config-instrument-data-path"><span class="std std-ref">NX_INSTRUMENT_DATA_PATH</span></a>) where this instrument stores its data (e.g. <code class="docutils literal notranslate"><span class="pre">./instrument_name</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">computer_name</span></code></p></td>
<td><p>TEXT</p></td>
<td><p>The hostname of the <code class="docutils literal notranslate"><span class="pre">support</span> <span class="pre">PC</span></code> connected to this instrument (for reference purposes)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">computer_ip</span></code></p></td>
<td><p>VARCHAR(15)</p></td>
<td><p>The IP address of the <code class="docutils literal notranslate"><span class="pre">support</span> <span class="pre">PC</span></code> connected to this instrument (not currently utilized)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">computer_mount</span></code></p></td>
<td><p>TEXT</p></td>
<td><p>The full path where the central file storage is mounted and files are saved on the ‘support PC’ for the instrument (for reference purposes)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">harvester</span></code></p></td>
<td><p>TEXT</p></td>
<td><p>The specific submodule within <a class="reference internal" href="../api/nexusLIMS/nexusLIMS.harvesters.html#module-nexusLIMS.harvesters" title="nexusLIMS.harvesters"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nexusLIMS.harvesters</span></code></a> that should be used to harvest reservation information for this instrument. Possible values: <code class="docutils literal notranslate"><span class="pre">nemo</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">timezone</span></code></p></td>
<td><p>TEXT</p></td>
<td><p>The timezone in which this instrument is located, in the format of the IANA timezone database (e.g. <code class="docutils literal notranslate"><span class="pre">America/New_York</span></code>). This is used to properly localize dates and times when communicating with the harvester APIs.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="uv_migration.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Migration from Poetry to uv</p>
      </div>
    </a>
    <a class="right-next"
       href="schema_documentation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">XML Schema Reference</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sqlmodel-orm-migration">SQLModel ORM Migration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#notable-changes">Notable Changes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#migration-examples">Migration Examples</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#database-migrations-with-alembic">Database Migrations with Alembic</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for-existing-installations">For Existing Installations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-alembic-commands">Common Alembic Commands</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-new-migrations">Creating New Migrations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#migration-configuration">Migration Configuration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#important-notes">Important Notes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#database-structure">Database Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-session-log-table">The <code class="docutils literal notranslate"><span class="pre">session_log</span></code> Table</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#purpose">Purpose</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-it-works">How It Works</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#table-schema">Table Schema</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-instruments-table">The <code class="docutils literal notranslate"><span class="pre">instruments</span></code> Table</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/dev_guide/database.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025 - 2026, datasophos, LLC.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>